<template name="partViewer">
  <div class="container-fluid part-viewer">
    {{#if part.isActive}}
    {{else}}
    <div class="row">
      <div class="alert alert-dismissible alert-warning">
        <button type="button" class="close" data-dismiss="alert">&times;</button>
        <h4 class="alert-heading">Warning!</h4>
        <p class="mb-0"><strong>This item is inactive</strong> - if you got here from an active kit or order please notify someone!</p>
      </div>
    </div>
    {{/if}}
    <div class="row">
      <div class="side-panel col-sm-3">
        <!-- Basic part information will go here -->
        <div class="card mb-3">
          <h3 class="card-header">{{ part.number }} - {{ part.revision }}</h3>
          <div class="card-body">
            <h5 class="card-title">{{ part.part.description }}</h5>
            <h6 class="card-subtitle">{{ part.part.size }}</h6>
            <p class="card-text">
              {{#each finish in part.part.finishes }}
                {{ finish }}<br/>
              {{/each}}
              {{ part.part.origin }}<br/>
              Location: {{ part.location.shelfId }}-{{ part.location.shelfNum }}<br/>
            </p>
            <table>
                <tbody>
                  <tr><td>Cost</td><td>{{ part.cost }}</td></tr>
                  <tr><td>Sale Price</td><td>{{ part.salePrice }}</td></tr>
                </tbody>
              </table>
            <p class="card-text"><small>Effective: {{ subDate part.effectiveDate }}</small></p>
          </div>
        </div>
        
      </div>
      <div class="rest col-sm-9">
        <!-- Other info like history and reqs will render into here -->
        <ul class="nav nav-tabs">
          <li class="nav-item">
            <a href="#history" class="nav-link active show" data-toggle="tab">History</a>
          </li>
          <li class="nav-item">
            <a href="#usedIn" class="nav-link" data-toggle="tab">Kits Used In</a>
          </li>
          <li class="nav-item">
            <a href="#reqs" class="nav-link" data-toggle="tab">Requirements</a>
          </li>
          <li class="nav-item">
            <a href="#forKits" class="nav-link" data-toggle="tab">For Kits</a>
          </li>
          <li class="nav-item">
            <a href="#inProcess" class="nav-link" data-toggle="tab">In Process</a>
          </li>
          <li class="nav-item">
            <a href="#files" class="nav-link" data-toggle="tab">Files</a>
          </li>
          <li class="nav-item">
            <a href="#aliases" class="nav-link" data-toggle="tab">Aliases</a>
          </li>
        </ul>

        <div class="tab-content" id="partTabContent">
        
          <div class="tab-pane fade active show" id="history">
            {{#if history}}
              <table class="table table-hover">
                <thead><tr>
                  
                </tr></thead>
                <tbody>
                  <!-- {{# each shipment in part.history }}
                    <tr>
                      <td>{{ subDate shipment.date }}</td>
                      <td>{{ shipment.quantity }}</td>
                      <td>{{ shipment.uom }}</td>
                      <td>{{ shipment.transactionType }}</td>
                      <td>{{ shipment.linkedOrder.company }}</td>
                      <td>{{ shipment.linkedOrder.refNumber }}</td>
                      <td>{{ shipment.processedInto.number }} - {{ shipment.processedInto.revision }}</td>
                    </tr>
                  {{/each}} -->
                  {{#each line in history}}
                    <tr>
                      <td>{{ line.quantity}}{{ line.uom }}</td>
                      <td>{{ line.itemNumber }} - {{ line.itemRevision }}</td>
                      <td>{{ line.transactionType }}</td>
                      <td>
                        {{#if line.usedInKit.number }}
                          {{ line.usedInKit.number }}
                        {{else}}
                          {{ line.linkedOrder.company }}
                        {{/if}}
                      </td>
                      <td>{{ line.linkedOrder.refNumber }}</td>
                      <td>{{ subDate line.date }}</td>
                    </tr>
                  {{/each}}
                </tbody>
              </table>
            {{else}}
              <h1>Loading Item History...</h1>
            {{/if}}
          </div>
          <div class="tab-pane fade" id="usedIn">
            <table class="table table-hover">
              {{# each part.usedIn }}
                <tr>
                  <td>{{ number }}</td>
                  <td>{{ revision }}</td>
                  <td>{{ quantityUsed }}</td>
                </tr>
              {{/each}}
            </table>
          </div>
          <div class="tab-pane fade" id="reqs">
            <table class="table table-hover">
              {{#each part.currentRequirements }}
                <tr>
                  <td>{{ location }}</td>
                  <td>{{ job }}</td>
                  <td>{{ subDate needDate }}</td>
                  <td>{{ issuedQty }}</td>
                  <td>{{ qty }}</td>
                </tr>
              {{/each}}
            </table>
          </div>
          <div class="tab-pane fade" id="forKits">
            <table class="table table-hover">
              {{#each line in forKits}}
              <tr>
                <td>{{ line.item.number }}</td>
                <td>{{ line.item.revision }}</td>
                <td>{{ line.item.simpleDescription }}</td>
                <td>{{ subDate line.reqDate }}</td>
                <td>{{ line.custOrderNumber }}</td>
                <td>{{ line.totalQtyNeeded }}</td>
              </tr>
              {{/each}}
            </table>
          </div>
          <div class="tab-pane fade" id="inProcess">
            <h1>In Process will go here</h1>
          </div>
          <div class="tab-pane fade" id="files">
            <h1>Files will go here</h1>
          </div>
          <div class="tab-pane fade" id="aliases">
            <h1>Aliases will go here</h1>
          </div>
          
        </div>
        
      </div>
    </div>
  </div>
</template>